<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculus Hub ‚Äî Buscador de temas</title>
  <style>
    :root{
      --bg: #0b1220;
      --card: #0f172aee;
      --text: #e5e7eb;
      --muted: #93a2b2;
      --border: #1f2a44;
      --accent: #38bdf8;
      --t1: #0ea5e95e;
      --t2: #22c55e3d;
      --t3: #ffffff08;
      --overscan: 16px;        /* Margen adicional para evitar cortes visuales */
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
      color:var(--text);
      background: transparent;
      overflow-x:hidden;
    }

    /* Capa base con gradiente oscuro continuo */
    .bg-base{
      position:fixed;
      inset: calc(var(--overscan) * -1);
      z-index:-3;
      pointer-events:none;
      background:
        radial-gradient(
          1200px 800px at 10% -10%,
          #10203b 0%,
          #0b1220 50%,
          #0a0f1b 100%
        );
      transform:translateZ(0);
    }

    /* Capa de fondo para animaci√≥n de part√≠culas */
    .bg-wrap{
      position:fixed;
      inset: calc(var(--overscan) * -1);
      z-index:-2;
      pointer-events:none;
      overflow:hidden;
      transform:translateZ(0);
    }
    canvas#calc-particles{
      display:block;
      width:100%;
      height:100%;
      filter:contrast(1.05) saturate(1.05);
    }

    /* Efectos de iluminaci√≥n y vi√±eta decorativa */
    .bg-vignette{
      position:fixed;
      inset: calc(var(--overscan) * -1);
      z-index:-1;
      pointer-events:none;
      background:
        radial-gradient(1000px 600px at 80% 10%, var(--t1), transparent 60%),
        radial-gradient(900px 600px at 20% 90%, var(--t2), transparent 60%),
        radial-gradient(1600px 900px at 50% 30%, var(--t3), transparent 60%);
      mix-blend-mode:screen;
      transform:translateZ(0);
    }

    .container{
      max-width:1120px;
      margin-inline:auto;
      padding:24px;
      position:relative;
      z-index:10;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:16px;
      padding-top:24px;
      padding-bottom:8px;
    }
    h1{
      margin:0;
      font-size:clamp(24px,3vw,32px);
      font-weight:800;
    }
    .subtitle{
      margin-top:4px;
      color:var(--muted);
      font-size:14px;
    }
    .team{
      color:var(--muted);
      text-align:right;
      font-size:14px;
    }
    .team .label{
      font-weight:600;
      color:#a7b4c3;
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      box-shadow:0 10px 30px rgba(2,8,23,.35);
      padding:16px;
      backdrop-filter: blur(6px);
    }

    form.search{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .input{
      flex:1;
      border:1px solid var(--border);
      background:#0b1220aa;
      color:var(--text);
      border-radius:12px;
      padding:12px 14px;
      font-size:16px;
      min-width:200px;
    }
    .input:focus{
      outline:3px solid #1f365f;
    }
    .btn{
      border:0;
      background:var(--accent);
      color:#06233a;
      border-radius:12px;
      padding:12px 16px;
      font-weight:800;
      cursor:pointer;
      flex-shrink:0;
    }
    .btn:hover{
      filter:brightness(1.05);
    }

    .result{
      margin-top:16px;
      display:none;
    }
    .box{
      border:1px solid var(--border);
      border-radius:16px;
      padding:16px;
      background:#0b1220b5;
    }
    .box h2{
      margin:0 0 6px 0;
      font-size:20px;
    }
    .box h3{
      margin:12px 0 4px 0;
      font-size:15px;
    }
    .muted{
      color:var(--muted);
    }

    .empty{
      margin-top:16px;
      border:1px dashed var(--border);
      border-radius:16px;
      padding:16px;
      text-align:center;
      color:#a8bacb;
      display:none;
      background:#0b1220a8;
      white-space:pre-line;
    }

    /* Contenedor del flipbook integrado */
    .flipbook{
      margin-top:24px;
      border:1px solid var(--border);
      border-radius:16px;
      overflow:hidden;
      background:#06101f;
      box-shadow:0 10px 30px rgba(2,8,23,.5);
    }
    .flipbook__head{
      padding:10px 14px;
      border-bottom:1px solid var(--border);
      background:#0b162a;
      color:#c8d3df;
      font-size:14px;
      font-weight:600;
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      row-gap:8px;
    }
    .flipbook__title{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:600;
    }
    .flipbook__hint{
      font-size:12px;
      color:#6b7a8c;
      font-weight:400;
    }
    .flipbook__body{
      aspect-ratio:16/9;
      width:100%;
      background:#000;
    }
    .flipbook__body iframe{
      width:100%;
      height:100%;
      border:0;
      background:#000;
      display:block;
      border-radius:0; /* Sin bordes redondeados para preservar el dise√±o del flipbook */
    }

    /* Estilos para subsecciones de resultados */
    .subs{
      margin-top:16px;
      border-top:1px solid var(--border);
      padding-top:16px;
    }
    .subs-block{
      margin-bottom:12px;
      background:#0f172a66;
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
    }
    .subs-block h4{
      margin:0 0 4px 0;
      font-size:14px;
      font-weight:600;
      color:var(--accent);
    }
    .subs-block p{
      margin:0;
      font-size:14px;
      line-height:1.4;
      color:var(--text);
      white-space:pre-line;
    }

    /* Overlay oscuro para el √≠ndice lateral */
    .index-overlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.45);
      opacity:0;
      pointer-events:none;
      transition:opacity .28s cubic-bezier(.22,1,.36,1);
      z-index: ninetyNine;
      /* Nivel z alto, por debajo del panel lateral */
      z-index:99;
    }
    .index-overlay.show{
      opacity:1;
      pointer-events:auto;
    }

    /* Panel lateral deslizante para el √≠ndice */
    .index-drawer{
      position:fixed;
      top:0; right:0; bottom:0;
      width:min(360px, 90vw);
      background:#0f172acc; /* Color consistente con las tarjetas principales */
      backdrop-filter: blur(6px);
      border-left:1px solid var(--border);
      box-shadow: -12px 0 30px rgba(2,8,23,.45);
      transform: translateX(100%);
      transition: transform .28s cubic-bezier(.22,1,.36,1);
      z-index:100; /* Nivel z superior al overlay */
      display:flex;
      flex-direction:column;
    }
    .index-drawer.open{
      transform: translateX(0);
    }
    .index-drawer__head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      padding:12px 14px;
      border-bottom:1px solid var(--border);
      background:#0b162a;
    }
    .index-drawer__title{
      margin:0;
      font-size:14px;
      font-weight:700;
      color:#c8d3df;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .index-drawer__close{
      border:1px solid var(--border);
      background:#1e293b;
      color:var(--text);
      border-radius:10px;
      width:32px;
      height:32px;
      line-height:30px;
      text-align:center;
      font-weight:800;
      cursor:pointer;
    }
    .index-drawer__close:hover{
      filter:brightness(1.08);
    }
    .index-drawer__list{
      padding:10px 10px 14px 10px;
      overflow:auto;
      flex:1;
    }
    .index-drawer__item{
      margin:0 0 8px 0;
      padding:10px 12px;
      background:#0b1220b5;
      border:1px solid var(--border);
      border-radius:12px;
      font-size:14px;
      font-weight:600;
      color:var(--text);
      cursor:pointer;
      transition: transform .06s ease;
      line-height:1.35;
    }
    .index-drawer__item:hover{
      transform: translateX(-2px);
      border-color:#284066;
    }

    footer{
      padding:24px 0 32px 0;
      text-align:center;
      color:#8aa0b5;
      font-size:12px;
    }
  </style>
</head>
<body>

  <!-- Capas de fondo con gradientes y efectos visuales -->
  <div class="bg-base"></div>
  <div class="bg-wrap"><canvas id="calc-particles"></canvas></div>
  <div class="bg-vignette" aria-hidden="true"></div>

  <div class="container">
    <header>
      <div>
        <h1>üìò Calculus Hub</h1>
        <p class="subtitle">
          ¬øPERO NOS EXONERAR√Å DEL EXAMEN POR TREMENDO DESARROLLO DE APP O NADOTA?
        </p>
      </div>
      <div class="team">
        <div class="label">Proyecto de:</div>
        <div>üë§ Ernesto Emanu√©l Santizo Santizo 1990-24-1077</div>
        <div>üë§ Jos√© Daniel Gonz√°les Monroy 5390-24-19904</div>
      </div>
    </header>

    <main>
      <div class="card">
        <!-- Formulario de b√∫squeda de temas -->
        <form class="search" id="search-form">
          <input id="q" class="input" placeholder="Ej: T√©cnicas de integraci√≥n" autocomplete="off" />
          <button class="btn" type="submit">Buscar</button>
          <button class="btn" type="button" id="btn-index">√çndice</button>
        </form>

        <!-- Mensaje cuando no hay resultados -->
        <div id="empty" class="empty"></div>

        <!-- Secci√≥n de resultado de b√∫squeda -->
        <section id="result" class="result">
          <div class="box">
            <h2 id="res-title">‚Äî</h2>

            <h3>Definici√≥n</h3>
            <p id="res-def">‚Äî</p>

            <h3>Ejemplo</h3>
            <p id="res-ex">‚Äî</p>

            <div id="res-subs" class="subs"></div>
          </div>
        </section>

        <!-- Flipbook integrado permanentemente visible -->
        <section class="flipbook">
          <div class="flipbook__head">
            <div class="flipbook__title">
              <span>Flipbook:</span>
              <span>James Stewart ‚Äì C√°lculo (edici√≥n de estudio)</span>
            </div>
            <div class="flipbook__hint">
              P√°ginas navegables tipo libro ‚Ä¢ Click / swipe / ‚Üê ‚Üí
            </div>
          </div>
          <div class="flipbook__body">
            <iframe
              id="flip-iframe"
              src="flipbook/index.html"
              title="Flipbook de C√°lculo">
            </iframe>
          </div>
        </section>

      </div>
    </main>

    <footer>HECHO CON ‚ù§Ô∏è PARA APRENDER C√ÅLCULO</footer>
  </div>

  <!-- Overlay para oscurecer el fondo del √≠ndice -->
  <div id="index-overlay" class="index-overlay"></div>

  <!-- Panel lateral con √≠ndice de temas -->
  <aside id="index-drawer" class="index-drawer" aria-label="√çndice de temas">
    <div class="index-drawer__head">
      <h3 class="index-drawer__title">üìö √çndice</h3>
      <button id="drawer-close" class="index-drawer__close" type="button" aria-label="Cerrar">√ó</button>
    </div>
    <div id="drawer-list" class="index-drawer__list"></div>
  </aside>

  <script>
  // Cat√°logo de temas de c√°lculo
  const TOPICS = [
    {
      id: "introduccion-calculo-integral",
      title: "Introducci√≥n al c√°lculo integral",
      slug: "introduccion-calculo-integral",
      definition:
        "El c√°lculo integral estudia las √°reas bajo curvas, acumulaci√≥n de cantidades y procesos inversos a la derivada. Parte de la idea de la 'antiderivada' o integral indefinida F(x) tal que F'(x)=f(x), y culmina en la integral definida, que da un n√∫mero asociado al √°rea firmada entre una funci√≥n y el eje x en un intervalo. Tambi√©n conecta con conceptos vistos en c√°lculo diferencial: l√≠mite, derivada y cambio instant√°neo.",
      example:
        "Si f(x)=5x¬≤+7x‚àí9 entonces una antiderivada es F(x)= (5/3)x¬≥+(7/2)x¬≤‚àí9x+C. La derivada de F vuelve a ser f. Esto es la base para luego calcular √°reas con integrales definidas.",
      subsections: [
        { title:"Antiderivada", desc:"Una funci√≥n F cuya derivada es f. ‚à´f(x)dx = F(x)+C." },
        { title:"Integral definida", desc:"‚à´‚Çê·µá f(x) dx como √°rea firmada bajo la curva." }
      ],
      keywords: [
        "introduccion","introducci√≥n","calculo integral","c√°lculo integral",
        "antiderivada","integral definida","area bajo la curva","√°rea bajo la curva",
        "limite","derivada","clase 1"
      ],
    },

    {
      id: "teorema-fundamental-calculo",
      title: "Teorema Fundamental del C√°lculo",
      slug: "teorema-fundamental-del-calculo",
      definition:
        "El Teorema Fundamental del C√°lculo une derivar e integrar. (1) Si F'(x)=f(x), entonces ‚à´‚Çê·µá f(x) dx = F(b) ‚àí F(a). Esto permite evaluar integrales definidas sin tener que aproximar √°reas con sumas. (2) La funci√≥n A(x)=‚à´‚ÇêÀ£ f(t) dt tiene derivada A'(x)=f(x). Adem√°s se estudian propiedades de la integral definida: linealidad, aditividad por intervalos y simetr√≠a. Para funciones pares/impares en intervalos [‚àía,a] se simplifican muchos c√°lculos.",
      example:
        "Ejemplo directo: si f(x)=2x¬≥‚àí6x+3/(x¬≤+1), una antiderivada es F(x)= (1/2)x‚Å¥‚àí3x¬≤+3¬∑arctan(x). Entonces ‚à´‚ÇÄ¬≤ f(x) dx = F(2) ‚àí F(0). Tambi√©n, si g(x) es impar, ‚à´‚Çã‚Çê·µÉ g(x) dx = 0.",
      subsections: [
        { title:"Funciones pares e impares", desc:"Atajos de simetr√≠a en [‚àía,a]." },
        { title:"Linealidad", desc:"Separar integrales en sumas y constantes." }
      ],
      keywords: [
        "teorema fundamental","fundamental del calculo","fundamental del c√°lculo",
        "propiedades de la integral","simetria","simetr√≠a","funciones pares",
        "funciones impares","integral definida","clase 2"
      ],
    },

    {
      id: "tecnicas-integracion",
      title: "T√©cnicas de integraci√≥n",
      slug: "tecnicas-integracion",
      definition:
        "Conjunto de m√©todos sistem√°ticos para encontrar antiderivadas o resolver integrales que no salen 'a ojo'. Entre las m√°s cl√°sicas est√°n: sustituci√≥n (cambio de variable), integraci√≥n por partes (derivar una parte y antiderivar la otra), fracciones parciales (descomponer funciones racionales), integrales trigonom√©tricas y trigonom√©tricas inversas. La idea general es transformar la integral original en otra m√°s f√°cil.",
      example:
        "Por partes: ‚à´ x¬∑e^x dx.\nElegimos u = x  ‚áí du = dx.\nElegimos dv = e^x dx ‚áí v = e^x.\nEntonces ‚à´ x¬∑e^x dx = u¬∑v ‚àí ‚à´ v¬∑du = x¬∑e^x ‚àí ‚à´ e^x dx = x¬∑e^x ‚àí e^x + C.",
      subsections: [
        { title:"Sustituci√≥n", desc:"Eleg√≠s u=g(x) para simplificar la integral." },
        { title:"Fracciones parciales", desc:"Descomponer funciones racionales en sumas simples." }
      ],
      keywords: [
        "tecnicas de integracion","t√©cnicas de integraci√≥n","metodos de integracion",
        "m√©todos de integraci√≥n","sustitucion","sustituci√≥n","fracciones parciales",
        "trigonom√©tricas","resolver integrales","clase 3"
      ],
    },

    {
      id: "integracion-por-partes",
      title: "Integraci√≥n por partes",
      slug: "integracion-por-partes",
      definition:
        "T√©cnica basada en la f√≥rmula ‚à´ u dv = u¬∑v ‚àí ‚à´ v du. Sirve cuando la integral es un producto de funciones donde derivar una las simplifica (por ejemplo logaritmos o polinomios) y la otra es f√°cil de integrar. Muy √∫til en expresiones tipo x¬∑ln x, x¬∑sin(x), x¬∑e^x, etc.",
      example:
        "Ejemplo: ‚à´ x¬∑ln(x) dx.\nTomamos u = ln(x) ‚áí du = (1/x) dx.\nTomamos dv = x dx ‚áí v = x¬≤/2.\nEntonces ‚à´ x¬∑ln(x) dx = (x¬≤/2)¬∑ln(x) ‚àí ‚à´ (x¬≤/2)¬∑(1/x) dx = (x¬≤/2)¬∑ln(x) ‚àí ‚à´ (x/2) dx = (x¬≤/2)¬∑ln(x) ‚àí x¬≤/4 + C.",
      subsections: [
        { title:"Elecci√≥n de u y dv", desc:"u mejora al derivarla; dv es f√°cil de integrar." }
      ],
      keywords: [
        "por partes","uv","integracion por partes","‚à´u dv","logaritmo","producto",
        "x ln x","x e^x","x sin x","clase 3"
      ],
    },

    {
      id: "area-entre-curvas",
      title: "√Årea entre curvas",
      slug: "area-entre-curvas",
      definition:
        "El √°rea entre dos funciones se obtiene integrando la diferencia entre la superior y la inferior. Si y = f(x) est√° arriba y y = g(x) est√° abajo en [a,b], entonces √Årea = ‚à´‚Çê·µá [f(x) ‚àí g(x)] dx. Cuando las curvas est√°n mejor descritas como x = f(y) y x = g(y), se integra respecto a y. Esto generaliza la idea de '√°rea bajo la curva' a regiones encerradas por varias curvas.",
      example:
        "Ejemplo t√≠pico: hallar el √°rea encerrada por y = x¬≤ y y = 2x ‚àí x¬≤. Primero se igualan para encontrar puntos de corte: x¬≤ = 2x ‚àí x¬≤ ‚áí 2x¬≤ ‚àí 2x = 0 ‚áí 2x(x‚àí1)=0 ‚áí x=0 y x=1.\nEn [0,1], la de arriba es 2x ‚àí x¬≤ y la de abajo es x¬≤.\n√Årea = ‚à´‚ÇÄ¬π [(2x ‚àí x¬≤) ‚àí x¬≤] dx = ‚à´‚ÇÄ¬π (2x ‚àí 2x¬≤) dx = [x¬≤ ‚àí (2/3)x¬≥]‚ÇÄ¬π = 1 ‚àí 2/3 = 1/3.",
      subsections: [
        { title:"Versi√≥n en x", desc:"Tiras verticales: ‚à´ (superior ‚àí inferior) dx." },
        { title:"Versi√≥n en y", desc:"Tiras horizontales: ‚à´ (derecha ‚àí izquierda) dy." }
      ],
      keywords: [
        "area entre curvas","√°rea entre curvas","√°rea encerrada","diferencia de funciones",
        "teorema area","integral definida area","clase 5"
      ],
    },

    {
      id: "integrales-impropias",
      title: "Integrales impropias",
      slug: "integrales-impropias",
      definition:
        "Son integrales donde el intervalo es infinito (ej. [1, ‚àû)) o la funci√≥n explota (tiene as√≠ntotas). Se definen como l√≠mites. Una integral impropia 'converge' si ese l√≠mite da un n√∫mero finito, y 'diverge' si no existe o es infinito. Permiten medir '√°reas infinitas' o acumulaciones en dominios ilimitados.",
      example:
        "1) ‚à´‚ÇÅ^‚àû (1/x) dx = lim_{b‚Üí‚àû} ‚à´‚ÇÅ·µá (1/x) dx = lim_{b‚Üí‚àû} [ln(x)]‚ÇÅ·µá = lim_{b‚Üí‚àû} ln(b) = ‚àû ‚áí diverge.\n2) ‚à´‚Çã‚àû^‚àû 1/(1+x¬≤) dx = œÄ. √âsta s√≠ converge y es finita.",
      subsections: [
        { title:"Infinito en el l√≠mite", desc:"Intervalos a ‚àû o ‚àí‚àû (definici√≥n por l√≠mites)." },
        { title:"Singularidades internas", desc:"As√≠ntotas dentro del intervalo: partir la integral y usar l√≠mites laterales." }
      ],
      keywords: [
        "integral impropia","integrales impropias","infinito","convergencia",
        "divergencia","limite en integrales","clase 6"
      ],
    },

    {
      id: "volumen-solidos-revolucion",
      title: "Vol√∫menes de s√≥lidos de revoluci√≥n",
      slug: "volumenes-solidos-revolucion",
      definition:
        "Si una regi√≥n plana gira alrededor de un eje, genera un s√≥lido 3D. Su volumen se halla con integraci√≥n. M√©todo de discos/arandelas: cortar el s√≥lido en rebanadas perpendiculares al eje de giro. Cada rebanada es un disco (o anillo) de radio r(x), espesor dx, volumen aproximado œÄ[r(x)]¬≤ dx. Sumando/integrando obtenemos el volumen exacto. Esto permite obtener vol√∫menes cl√°sicos como el de la esfera, el cono u objetos raros.",
      example:
        "Una esfera de radio r puede verse al rotar y = ‚àö(r¬≤ ‚àí x¬≤) alrededor del eje x. El volumen sale V = ‚à´‚Çã ≥ ≥ œÄ(r¬≤ ‚àí x¬≤) dx = 4/3 ¬∑ œÄ ¬∑ r¬≥.",
      subsections: [
        { title:"Discos", desc:"V = ‚à´ œÄ[R(x)]¬≤ dx (s√≥lido macizo)." },
        { title:"Arandelas", desc:"V = ‚à´ œÄ(R_externo¬≤ ‚àí R_interno¬≤) dx (con hueco)." }
      ],
      keywords: [
        "volumen de revolucion","s√≥lidos de revoluci√≥n","discos","arandelas",
        "m√©todo de discos","m√©todo de arandelas","volumen esfera","clase 7"
      ],
    },

    {
      id: "trabajo-e-integral",
      title: "Trabajo con fuerza variable",
      slug: "trabajo-con-fuerza-variable",
      definition:
        "El trabajo W de una fuerza que cambia con la posici√≥n no es F¬∑d simplemente: hay que sumar (integrar) fuerza √ó desplazamiento a lo largo del recorrido. Ejemplos t√≠picos: estirar un resorte (ley de Hooke F = kx), bombear agua desde un tanque (el peso del l√≠quido en cada rebanada cambia con la altura), levantar una cuerda que se va aligerando. Tambi√©n se ve el valor promedio de una funci√≥n en un intervalo como (1/(b‚àía))‚à´‚Çê·µá f(x) dx.",
      example:
        "Resorte: si F(x)=k¬∑x y queremos estirarlo de x=a a x=b, entonces el trabajo es W = ‚à´‚Çê·µá kx dx = (k/2)(b¬≤‚àía¬≤). Ejemplo num√©rico: con k=800 N/m, estirar de 0.15 m a 0.18 m requiere W=‚à´‚ÇÄ.‚ÇÅ‚ÇÖ‚Å∞.‚ÇÅ‚Çà 800x dx ‚âà 1.56 J.",
      subsections: [
        { title:"Ley de Hooke", desc:"F(x)=k¬∑x. Comportamiento lineal del resorte." },
        { title:"Valor promedio", desc:"f_promedio = (1/(b‚àía)) ‚à´‚Çê·µá f(x)dx." }
      ],
      keywords: [
        "trabajo","fuerza variable","ley de hooke","resorte","bomba de agua",
        "valor promedio de una funcion","valor promedio","clase 8"
      ],
    },

    {
      id: "vectores-3d",
      title: "Vectores en el espacio",
      slug: "vectores-3d",
      definition:
        "En 3D un punto tiene coordenadas (x,y,z). Un vector ‚ü®a,b,c‚ü© representa direcci√≥n y magnitud en ese espacio. La distancia entre P‚ÇÅ(x‚ÇÅ,y‚ÇÅ,z‚ÇÅ) y P‚ÇÇ(x‚ÇÇ,y‚ÇÇ,z‚ÇÇ) es ‚àö[(x‚ÇÇ‚àíx‚ÇÅ)¬≤+(y‚ÇÇ‚àíy‚ÇÅ)¬≤+(z‚ÇÇ‚àíz‚ÇÅ)¬≤]. Tambi√©n se ve el vector direcci√≥n entre dos puntos, el vector unitario (mismo sentido pero magnitud 1) y el producto punto, que sirve para √°ngulos y trabajo mec√°nico.",
      example:
        "Si P‚ÇÅ=(2,‚àí1,7) y P‚ÇÇ=(1,‚àí3,5), entonces ‚ÜíP‚ÇÅP‚ÇÇ = ‚ü®1‚àí2, ‚àí3‚àí(‚àí1), 5‚àí7‚ü© = ‚ü®‚àí1, ‚àí2, ‚àí2‚ü©. La distancia entre P‚ÇÅ y P‚ÇÇ es ‚àö[(-1)¬≤+(-2)¬≤+(-2)¬≤] = ‚àö9 = 3.",
      subsections: [
        { title:"Vector unitario", desc:"vÃÇ = v/||v||. Magnitud 1, misma direcci√≥n." },
        { title:"Producto punto", desc:"a¬∑b = |a||b|cosŒ∏. √ötil para √°ngulos y trabajo." }
      ],
      keywords: [
        "vectores","espacio tridimensional","coordenadas 3d","distancia 3d",
        "vector unitario","producto punto","trabajo","clase 9"
      ],
    },

    {
      id: "producto-cruz-plano",
      title: "Producto cruz y plano en 3D",
      slug: "producto-cruz-y-plano",
      definition:
        "El producto cruz (o vectorial) entre dos vectores en 3D da un nuevo vector perpendicular a ambos. Su magnitud representa el √°rea del paralelogramo que forman. Con el producto cruz se define el torque (momento de torsi√≥n) œÑ = r √ó F y tambi√©n un vector normal a un plano. Con un vector normal ‚ü®A,B,C‚ü© y un punto (x‚ÇÄ,y‚ÇÄ,z‚ÇÄ) se puede escribir la ecuaci√≥n de un plano: A(x‚àíx‚ÇÄ)+B(y‚àíy‚ÇÄ)+C(z‚àíz‚ÇÄ)=0.",
      example:
        "Torque: si aplico una fuerza de magnitud 40 N en el extremo de una llave de 0.25 m con √°ngulo de 75¬∞, el momento aproximado es œÑ = r¬∑F¬∑sin(Œ∏) ‚âà 0.25¬∑40¬∑sin(75¬∞) ‚âà 9.66 N¬∑m.",
      subsections: [
        { title:"Producto cruz", desc:"Vector perpendicular; √°rea del paralelogramo." },
        { title:"Ecuaci√≥n del plano", desc:"A(x‚àíx‚ÇÄ)+B(y‚àíy‚ÇÄ)+C(z‚àíz‚ÇÄ)=0 con normal ‚ü®A,B,C‚ü©." }
      ],
      keywords: [
        "producto cruz","producto vectorial","torque","momento de torsion",
        "momento de torsi√≥n","plano","vector normal","ecuacion del plano","clase 11"
      ],
    },

    {
      id: "derivadas-parciales",
      title: "Derivadas parciales",
      slug: "derivadas-parciales",
      definition:
        "Cuando una funci√≥n depende de varias variables (por ejemplo z = f(x,y)), podemos estudiar c√≥mo cambia con respecto a una sola variable, manteniendo las dem√°s fijas. Eso es la derivada parcial. fx(x,y) mide c√≥mo cambia f si mov√©s x un poquito y dej√°s y fijo. Estas ideas se usan en superficies de varias variables, temperatura en el espacio, etc. Tambi√©n aparecen las superficies de nivel: curvas o superficies donde f(x,y,z)=k es constante.",
      example:
        "Si f(x,y)=x¬≥ + x¬≤y¬≥ ‚àí 2y¬≤:\nfx(x,y)=3x¬≤+2xy¬≥, as√≠ fx(2,1)=16.\nfy(x,y)=3x¬≤y¬≤‚àí4y, as√≠ fy(2,1)=8.\nEso te dice qu√© tan sensible es f a cambios en x o en y, en el punto (2,1).",
      subsections: [
        { title:"Superficies/curvas de nivel", desc:"f(x,y)=k o f(x,y,z)=k." },
        { title:"Orden superior", desc:"fxx, fxy, fyx, fyy; bajo suavidad, fxy=fyx." }
      ],
      keywords: [
        "derivada parcial","derivadas parciales","fx","fy","multivariable",
        "superficies de nivel","curvas de nivel","clase 12"
      ],
    },

    {
      id: "regla-de-la-cadena-multivariable",
      title: "Regla de la cadena (multivariable)",
      slug: "regla-cadena-multivariable",
      definition:
        "Extiende la regla de la cadena de una variable al caso en que z depende de x e y, y a su vez x e y dependen de otro par√°metro (t) o de m√°s par√°metros (s,t). B√°sicamente: si z=f(x,y), x=g(t), y=h(t), entonces dz/dt = (‚àÇf/‚àÇx)(dx/dt) + (‚àÇf/‚àÇy)(dy/dt). Esto permite encontrar razones de cambio totales aunque las variables est√©n relacionadas de manera indirecta.",
      example:
        "Si z = x¬≤y + 3xy‚Å¥ con x = sin(2t) y y = cos(t), entonces dz/dt se calcula sustituyendo fx, fy, dx/dt y dy/dt en la f√≥rmula. Al evaluar en t=0 se obtiene dz/dt = 6. Ese 6 es la rapidez instant√°nea de cambio de z con respecto a t en ese punto.",
      subsections: [
        { title:"Caso 1 (una variable t)", desc:"dz/dt = fx¬∑x'(t)+fy¬∑y'(t)." },
        { title:"Caso 2 (dos par√°metros)", desc:"dz/ds y dz/dt usando parciales y derivadas de x(s,t), y(s,t)." }
      ],
      keywords: [
        "regla de la cadena","multivariable","dz/dt","cambio total","dependencia indirecta",
        "parametrizacion","parametrizaci√≥n","clase 13"
      ],
    },

    {
      id: "extremos-multivariable",
      title: "M√°ximos y m√≠nimos en varias variables",
      slug: "maximos-minimos-2variables",
      definition:
        "Para funciones f(x,y) se buscan puntos cr√≠ticos donde fx=0 y fy=0. Luego se usa la prueba de la segunda derivada (matriz Hessiana) para clasificar si el punto es m√°ximo local, m√≠nimo local o punto de silla. Tambi√©n se pueden buscar extremos absolutos en una regi√≥n cerrada analizando bordes. Es la versi√≥n 2D (o 3D) de lo que ya hac√≠as con m√°ximos y m√≠nimos en una variable.",
      example:
        "Si f(x,y)=x¬≤+y¬≤‚àí4x‚àí6y+13, calcul√°s fx=2x‚àí4 y fy=2y‚àí6. Igualando a 0: x=2, y=3. Al evaluar f(2,3)=0. Ese punto es un m√≠nimo (la forma es parab√≥lica hacia arriba).",
      subsections: [
        { title:"Punto cr√≠tico", desc:"fx=0 y fy=0." },
        { title:"Clasificaci√≥n", desc:"Hessiano para decidir m√≠nimo, m√°ximo o silla." }
      ],
      keywords: [
        "maximo","m√°ximo","minimo","m√≠nimo","punto critico","puntos criticos",
        "hessiano","segunda derivada","extremos relativos","clase 14"
      ],
    },

    {
      id: "integrales-dobles",
      title: "Integrales dobles",
      slug: "integrales-dobles",
      definition:
        "Una integral doble ‚à¨_D f(x,y) dA acumula valores de f sobre una regi√≥n D del plano. Sirve para calcular √°rea (si f=1), masa (si f es densidad superficial), promedios, etc. La regi√≥n D puede ser un rect√°ngulo o una regi√≥n m√°s general. Muchas veces se eval√∫a convirti√©ndola en una integral iterada: ‚à´[x=a‚Üíb] ‚à´[y=g1(x)‚Üíg2(x)] f(x,y) dy dx (regi√≥n tipo 1) o al rev√©s (tipo 2).",
      example:
        "Si D est√° limitada por y=2x¬≤ y y=1+x¬≤, se puede describir como tipo 1: x va de ‚àí1 a 1 y para cada x, y va de 2x¬≤ a 1+x¬≤. Entonces ‚à¨_D (x+2y) dA = ‚à´_{x=-1}^{1} ‚à´_{y=2x¬≤}^{1+x¬≤} (x+2y) dy dx. Ese proceso convierte el √°rea curva en una suma ordenada.",
      subsections: [
        { title:"Regi√≥n tipo I / II", desc:"Eleg√≠ describir en x o en y seg√∫n convenga." },
        { title:"Interpretaci√≥n f√≠sica", desc:"Masa si f es densidad superficial." }
      ],
      keywords: [
        "integral doble","integrales dobles","region tipo 1","region tipo 2",
        "area bajo superficie","masa superficial","clase 14","semana 14","tipo 1","tipo 2"
      ],
    },

    {
      id: "integrales-triples",
      title: "Integrales triples",
      slug: "integrales-triples",
      definition:
        "La integral triple ‚à≠_E f(x,y,z) dV suma valores de f en todo un volumen 3D E. Se usa para volumen (si f=1), masa (si f es densidad volum√©trica), centro de masa, etc. En cajas rectangulares se puede usar una versi√≥n 3D del Teorema de Fubini para evaluarla como integrales iteradas una tras otra. Para regiones m√°s complicadas (como un tetraedro) se describe el s√≥lido con cotas en z, luego y, luego x (o en otro orden) y se integra paso a paso.",
      example:
        "Ejemplo caja: Si B = {0‚â§x‚â§1, ‚àí1‚â§y‚â§2, 0‚â§z‚â§3} y queremos ‚à≠_B x¬∑y¬∑z¬≤ dV, integramos primero en x, luego en y, luego en z. Para una regi√≥n piramidal (tetraedro) limitada por x=0, y=0, z=0 y x+y+z=1, podemos describir 0‚â§z‚â§1‚àíx‚àíy, 0‚â§y‚â§1‚àíx, 0‚â§x‚â§1 y evaluar ‚à≠ z dV, que da un valor finito.",
      subsections: [
        { title:"Fubini (3D)", desc:"Permite evaluar como integrales iteradas." },
        { title:"Interpretaci√≥n f√≠sica", desc:"Masa total si f es densidad volum√©trica." }
      ],
      keywords: [
        "integral triple","integrales triples","fubini 3d","volumen en 3d",
        "densidad volumetrica","tetraedro","caja rectangular","clase 15","semana 15"
      ],
    },
  ];

  // Temas visuales por tipo de contenido
  const THEMES = {
    default: { accent:"#38bdf8", t1:"#0ea5e95e", t2:"#22c55e3d" },

    "introduccion-calculo-integral": { accent:"#38bdf8", t1:"#38bdf85e", t2:"#22c55e33" },
    "teorema-fundamental-calculo":   { accent:"#38bdf8", t1:"#38bdf85e", t2:"#22c55e33" },

    "tecnicas-integracion":          { accent:"#38bdf8", t1:"#38bdf85e", t2:"#22c55e33" },
    "integracion-por-partes":        { accent:"#a78bfa", t1:"#a78bfa4d", t2:"#22c55e26" },

    "area-entre-curvas":             { accent:"#22c55e", t1:"#22c55e3d", t2:"#38bdf82e" },
    "integrales-impropias":          { accent:"#fbbf24", t1:"#fbbf2433", t2:"#38bdf826" },

    "volumen-solidos-revolucion":    { accent:"#e879f9", t1:"#e879f94d", t2:"#38bdf826" },
    "trabajo-e-integral":            { accent:"#60a5fa", t1:"#60a5fa4d", t2:"#22c55e26" },

    "vectores-3d":                   { accent:"#34d399", t1:"#34d39933", t2:"#38bdf826" },
    "producto-cruz-plano":           { accent:"#a78bfa", t1:"#a78bfa4d", t2:"#22c55e26" },

    "derivadas-parciales":           { accent:"#f43f5e", t1:"#f43f5e40", t2:"#0ea5e933" },
    "regla-de-la-cadena-multivariable": { accent:"#f43f5e", t1:"#f43f5e40", t2:"#0ea5e933" },

    "extremos-multivariable":        { accent:"#facc15", t1:"#facc1540", t2:"#22c55e26" },

    "integrales-dobles":             { accent:"#38bdf8", t1:"#38bdf85e", t2:"#22c55e33" },
    "integrales-triples":            { accent:"#a78bfa", t1:"#a78bfa4d", t2:"#22c55e26" },
  };

  const FUNNY = [
    "Ni los de la USAC con 10 a√±os de carrera lo han visto.",
    "Lo busqu√© en la feria del libro‚Ä¶ solo vend√≠an atol y fotocopias.",
    "Busqu√© hasta en los apuntes del maje que siempre saca 100, y ni as√≠.",
    "Error 404: tema no encontrado (Fijo nada que ver con calculo 2).",
    "Nada vos‚Ä¶ ni el maje de la primera fila tiene apuntes de eso.",
    "Nada. Igual tranqui, a veces el profe tampoco lo explica üòè.",
    "Ni los del congreso saben que es. Pajas ellos no saben nada jaja",
  ];

  // Referencias a elementos del DOM
  const $ = (sel) => document.querySelector(sel);
  const $form = $('#search-form');
  const $q = $('#q');
  const $empty = $('#empty');
  const $result = $('#result');
  const $title = $('#res-title');
  const $def = $('#res-def');
  const $ex = $('#res-ex');
  const $subs = $('#res-subs');

  // Referencias para panel lateral y overlay
  const $btnIndex = $('#btn-index');
  const $drawer   = $('#index-drawer');
  const $dClose   = $('#drawer-close');
  const $dList    = $('#drawer-list');
  const $overlay  = $('#index-overlay');

  const normalize = (s) =>
    s.toLowerCase()
     .normalize('NFD')
     .replace(/\p{Diacritic}/gu,'')
     .trim();

  function search(q){
    if(!q) return null;
    const nq = normalize(q);
    for(const t of TOPICS){
      const hay = normalize([
        t.title,
        t.definition,
        t.example,
        ...(t.keywords||[])
      ].join(' '));
      if(hay.includes(nq)) return t;
    }
    return null;
  }

  function setTheme(key){
    const t = THEMES[key] || THEMES.default;
    const root = document.documentElement;
    root.style.setProperty('--accent', t.accent);
    root.style.setProperty('--t1', t.t1);
    root.style.setProperty('--t2', t.t2);
    if (window.__calcParticlesResize) requestAnimationFrame(window.__calcParticlesResize);
  }

  function renderSubsections(list){
    $subs.innerHTML = "";
    if(!list || !list.length){
      $subs.style.display = "none";
      return;
    }
    $subs.style.display = "block";
    list.forEach(block=>{
      const div = document.createElement("div");
      div.className = "subs-block";
      div.innerHTML = `<h4>${block.title}</h4><p>${block.desc}</p>`;
      $subs.appendChild(div);
    });
  }

  function showEmpty(msg){
    $empty.textContent = msg;
    $empty.style.display = 'block';
    $result.style.display = 'none';
    setTheme('default');
  }

  function showResult(t){
    $title.textContent = t.title;
    $def.textContent   = t.definition;
    $ex.textContent    = t.example;
    renderSubsections(t.subsections || []);
    $result.style.display = 'block';
    $empty.style.display = 'none';
    setTheme(t.id);
  }

  // Construcci√≥n y gesti√≥n del √≠ndice lateral
  function buildDrawerList(){
    $dList.innerHTML = "";
    TOPICS.forEach(topic=>{
      const item = document.createElement("div");
      item.className = "index-drawer__item";
      item.textContent = topic.title;
      item.addEventListener("click", ()=>{
        showResult(topic);
        $q.value = topic.title;
        closeDrawer();
      });
      $dList.appendChild(item);
    });
  }

  function openDrawer(){
    buildDrawerList();
    $drawer.classList.add('open');   // slide-in
    $overlay.classList.add('show');  // mostrar overlay
  }
  function closeDrawer(){
    $drawer.classList.remove('open'); // slide-out
    $overlay.classList.remove('show'); // ocultar overlay
  }

  // Eventos para abrir y cerrar el √≠ndice
  $btnIndex.addEventListener('click', openDrawer);
  $dClose.addEventListener('click', closeDrawer);
  $overlay.addEventListener('click', closeDrawer);

  // Procesamiento del formulario de b√∫squeda
  $form.addEventListener('submit', (e)=>{
    e.preventDefault();
    const q = $q.value;
    if(!q.trim()){
      showEmpty('Escrib√≠ un tema de c√°lculo para empezar ‚úçÔ∏è');
      return;
    }
    const found = search(q);
    if(found){
      showResult(found);
    }else{
      showEmpty(
        FUNNY[Math.floor(Math.random()*FUNNY.length)]
        + `\n(No hay resultados para "${q}")`
      );
    }
  });

  // Inicializaci√≥n de la interfaz
  showEmpty('Escrib√≠ un tema de c√°lculo para empezar ‚úçÔ∏è');

  // Sistema de animaci√≥n de part√≠culas matem√°ticas
  (function calcParticles(){
    const canvas = document.getElementById('calc-particles');
    const ctx = canvas.getContext('2d', { alpha: true });
    const DPR = Math.min(window.devicePixelRatio || 1, 2);
    const OV = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--overscan')) || 16;

    const GLYPHS = ['‚à´','Œ£','œÄ','‚àÇ','‚àö','‚àû','lim','dx'];
    const COLORS  = ['#38bdf8','#22c55e','#e879f9','#fbbf24','#f43f5e','#a78bfa','#34d399','#60a5fa'];

    let CSSW=0, CSSH=0, W=0, H=0, symbols=[];
    let mouse={x:0,y:0};

    function resize(){
      // Calcula tama√±o del canvas con m√°rgenes adicionales
      CSSW = Math.max(1, window.innerWidth  + OV*2);
      CSSH = Math.max(1, window.innerHeight + OV*2);
      W = Math.round(CSSW * DPR);
      H = Math.round(CSSH * DPR);
      canvas.width = W;
      canvas.height = H;

      // Ajusta transformaci√≥n para pixel ratio y m√°rgenes
      ctx.setTransform(1,0,0,1,0,0);
      ctx.scale(DPR, DPR);
      ctx.translate(OV, OV);

      spawn();
    }

    const rand = (a,b)=> a + Math.random()*(b-a);
    const pick = (arr)=> arr[Math.floor(Math.random()*arr.length)];

    function spawn(){
      const count = Math.max(60, Math.min(120,
        Math.round((CSSW*CSSH)/20000)
      ));
      symbols = Array.from({length: count}, ()=> ({
        g: pick(GLYPHS),
        x: Math.random() * CSSW - OV,
        y: Math.random() * CSSH - OV,
        z: rand(.6, 1.6),
        vx: rand(-.25, .25),
        vy: rand(.15, .55),
        r: rand(-.02, .02),
        a: rand(0, Math.PI*2),
        color: pick(COLORS)
      }));
    }

    function step(){
      // Limpia el canvas incluyendo m√°rgenes
      ctx.clearRect(-OV, -OV, CSSW, CSSH);

      const parx = ((mouse.x+OV)/CSSW - .5) * 6;
      const pary = ((mouse.y+OV)/CSSH - .5) * 6;

      // Dibuja conexiones entre s√≠mbolos cercanos
      ctx.save();
      ctx.strokeStyle = '#93c5fd';
      for(let i=0;i<symbols.length;i++){
        for(let j=i+1;j<symbols.length;j++){
          const a = symbols[i], b = symbols[j];
          const dx = a.x - b.x, dy = a.y - b.y;
          const dist = Math.hypot(dx,dy);
          if(dist < 120){
            ctx.globalAlpha = 0.12 * (1 - dist/120);
            ctx.lineWidth = 0.6;
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            ctx.stroke();
          }
        }
      }
      ctx.restore();

      symbols.forEach(s=>{
        s.x += s.vx + parx*0.01*s.z;
        s.y += s.vy + pary*0.01*s.z;
        s.a += s.r;

        // Reposiciona part√≠culas que salen del √°rea visible
        if(s.x < -OV-30) s.x = CSSW-OV+30;
        if(s.x > CSSW-OV+30) s.x = -OV-30;
        if(s.y > CSSH-OV+30) {
          s.y = -OV-30;
          s.x = Math.random() * CSSW - OV;
        }

        ctx.save();
        ctx.translate(s.x, s.y);
        ctx.rotate(s.a);
        ctx.font = `${18*s.z + 8}px ui-sans-serif, system-ui`;
        ctx.fillStyle = s.color;
        ctx.globalAlpha = 0.78;
        ctx.fillText(s.g, 0, 0);
        ctx.restore();
      });

      requestAnimationFrame(step);
    }

    function onMouse(e){
      mouse.x = e.clientX;
      mouse.y = e.clientY;
    }

    window.addEventListener('resize', resize, {passive:true});
    window.addEventListener('orientationchange', resize, {passive:true});
    window.addEventListener('mousemove', onMouse, {passive:true});
    document.addEventListener('visibilitychange', ()=> {
      if(!document.hidden) resize();
    });

    resize();
    requestAnimationFrame(step);

    // Funci√≥n global para redimensionar al cambiar el tema
    window.__calcParticlesResize = () => { resize(); };
  })();
  </script>

</body>
</html>
